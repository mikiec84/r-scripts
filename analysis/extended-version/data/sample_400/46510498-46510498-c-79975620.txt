Please create a minimal reproduction. There seems to be too much clutter in your code which is not related to your actual question. By isolating the problem, you're likely to find the solution yourself (and learn a couple of things along the way).

