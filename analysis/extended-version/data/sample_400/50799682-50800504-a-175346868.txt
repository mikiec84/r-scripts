There's more than one way to skin this cat in T-SQL, but my preference would be :
Result:

