I've updated my answer with the code I'm using.

