I've changed my answer to show the complete implementation.

