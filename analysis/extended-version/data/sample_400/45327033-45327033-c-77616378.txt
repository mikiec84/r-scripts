@Phylogenesis: It is the lib I'm already using. As I said, it's buggy for ranges like what I have. But anyway, thanks for the suggestion.

