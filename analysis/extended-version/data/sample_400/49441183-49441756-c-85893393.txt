Please see edit, posted the code snippet involved.

